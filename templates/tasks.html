<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>TaskScore â€“ Aufgaben</title>
  <style>
    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;margin:0;padding:0;background:#f4f5f7}
    header{
      background:#1f2933;color:#fff;padding:16px 24px}
    header h1{
      margin:0;font-size:1.6rem}
    main{
      max-width:900px;margin:24px auto;padding:0 16px 32px}
    .card{
      background:hsl(173, 35%, 82%);border-radius:12px;padding:20px 24px;box-shadow:0 2px 6px rgba(0,0,0,.08);margin:0 0 16px}
    .nav a{
      display:inline-block;margin-right:5px;text-decoration:none;color:#2c64d5;font-weight:500;padding:8px 14px;border:2px solid #000;border-radius:10px;transition:.2s;background:#fff}
    .nav a:hover{
      background:#2563eb;color:#fff}
    .muted{
      color:#000;font-size:.9rem}
    label{
      display:block;font-size:.9rem;margin-top:10px}
    input,textarea{
      width:100%;box-sizing:border-box;padding:10px;border-radius:10px;border:1px solid #d1d5db;margin-top:6px;font-size:.95rem;background:#fff}
    textarea{
      min-height:90px;resize:vertical}
    button{
      display:inline-block;margin-top:5px;margin-right:5px;color:#2c64d5;font-weight:500;padding:8px 14px;border:2px solid #000;border-radius:10px;background:#fff;cursor:pointer;transition:.2s;font-family:inherit;font-size:.95rem;line-height:1.2}
    button:hover{
      background:#2563eb;color:#fff}
    table{
      width:100%;border-collapse:collapse;margin-top:10px}
    th,td{
      text-align:left;padding:10px 8px;border-bottom:1px solid #e5e7eb;vertical-align:top}
    th{
      font-size:.85rem;color:#374151}
    .alert-error{
      margin-bottom:12px;padding:10px 14px;background:#fee2e2;color:#991b1b;border-radius:10px;font-size:.9rem}
    .btn-pill{
      margin-top:0;padding:4px 10px;font-size:.8rem;border-radius:999px;border:0;cursor:pointer}
    .status-done{
      background:#00b03e;color:#fff}
    .status-open{
      background:#f90000;color:#fff}
    .btn-delete{
      background:#fff;color:#000}

    .weekday-details{
      margin-top:6px}
    .weekday-summary{
      list-style:none;width:100%;box-sizing:border-box;padding:10px;border-radius:10px;border:1px solid #d1d5db;background:#fff;cursor:pointer;font-size:.95rem
    }
    .weekday-details > summary::-webkit-details-marker{
      display:none}
    .weekday-details[
    open] 
    .weekday-summary{
      border-bottom-left-radius:0;border-bottom-right-radius:0}
    .weekday-box{
      border:1px solid #d1d5db;border-top:0;padding:10px;background:#fff;border-bottom-left-radius:10px;border-bottom-right-radius:10px
    }

    .weekday-grid{
      display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .weekday-grid label{
      display:flex;align-items:center;gap:6px;font-size:.95rem;margin-top:0}
    .weekday-grid input[
    type="checkbox"]{width:auto;margin:0}
  </style>
</head>

<body>
  <header>
    <h1>TaskScore â€“ Aufgaben</h1>
  </header>

  <main>
    <section class="card nav">
      <h2>Navigation ğŸ§­</h2>
      <a href="/">HauptmenÃ¼</a>
      <a href="/plan">Wochenplan ansehen</a>
      <a href="/progress">Fortschritt anzeigen</a>
    </section>

    <section class="card">
      <h2>Neue Aufgabe anlegen</h2>

      <p class="h2"><u><i><strong>{{ current_total }}/ {{ budget }} Punkte verwendet</strong></i></u></p>
      <p class="label"><strong>Kleiner Tipp ğŸ’­: Rechne mit maximal 14-15 Punkten pro Tag.</strong></p>

      {% if error %}
        <div class="alert-error">{{ error }}</div>
      {% endif %}

      <form method="post" action="/tasks">
        <label>Titel âš’ï¸</label>
        <input name="title" required>

        <label>Beschreibung âœ’ï¸</label>
        <textarea name="description"></textarea>

        <label>Wochentage ğŸ—“ï¸</label>
        <details class="weekday-details">
          <summary class="weekday-summary">Tage auswÃ¤hlenâ€¦</summary>
          <div class="weekday-box">
            <div class="weekday-grid">
              <label><input type="checkbox" name="weekdays" value="Montag ğŸ’¼"> Montag ğŸ’¼</label>
              <label><input type="checkbox" name="weekdays" value="Dienstag ğŸ“Š"> Dienstag ğŸ“Š</label>
              <label><input type="checkbox" name="weekdays" value="Mittwoch â³"> Mittwoch â³</label>
              <label><input type="checkbox" name="weekdays" value="Donnerstag ğŸ¯"> Donnerstag ğŸ¯</label>
              <label><input type="checkbox" name="weekdays" value="Freitag ğŸ"> Freitag ğŸ</label>
              <label><input type="checkbox" name="weekdays" value="Samstag ğŸ•º"> Samstag ğŸ•º</label>
              <label><input type="checkbox" name="weekdays" value="Sonntag ğŸŒ¿"> Sonntag ğŸŒ¿</label>
            </div>
          </div>
        </details>

        <label>PunkteğŸ’°</label>
        <input type="number" name="points_total" value="0" min="0">

        <button type="submit">Aufgabe hinzufÃ¼gen</button>
      </form>
    </section>

    <section class="card">
      <h2>Geplante Aufgaben</h2>

      {% if tasks %}
        <table>
          <thead>
            <tr>
              <th>Titel</th><th>Tag</th><th>Punkte</th><th>Status</th><th>Aktion</th>
            </tr>
          </thead>
          <tbody>
            {% for t in tasks %}
              <tr>
                <td>
                  <strong>{{ t.title }}</strong><br>
                  <span class="muted">{{ t.description }}</span>
                </td>
                <td>{{ t.weekday }}</td>
                <td>{{ t.points_total }}</td>

                <td>
                  <form method="post" action="/tasks/{{ t.id }}/toggle">
                    <button type="submit"
                      class="btn-pill {% if t.status == 'DONE' %}status-done{% else %}status-open{% endif %}">
                      {{ t.status }}
                    </button>
                  </form>
                </td>

                <td>
                  <form method="post" action="/tasks/{{ t.id }}/delete">
                    <button type="submit" class="btn-pill btn-delete">LÃ¶schen</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="muted">Noch keine Aufgaben vorhanden.</p>
      {% endif %}
    </section>
  </main>
</body>
</html>